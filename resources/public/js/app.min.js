/*! FangChia.com
* Copyright (c) 2016 Coby Tamayo; Licensed  */
function Router(){this.routes=[],this.matchedRoutes=[]}function Nav(a){window.addEventListener("navigate",a),window.addEventListener("popstate",a)}Router.prototype.addRoute=function(a,b,c){c=c||"[-\\w]+",this.routes.push({pattern:a,handler:b,regexp:new RegExp(c,"gi")})},Router.prototype.match=function(a){if(!this.matchedRoutes[a]){var b=this;this.routes.forEach(function(c){var d=new RegExp("^"+c.pattern.replace(/:\w+/g,c.regexp.source)+"$");d.test(a)&&(b.matchedRoutes[a]={url:a,pattern:c.pattern,params:b.getMatchedParams(a,c.pattern,c.regexp),handler:c.handler})})}return this.matchedRoutes[a]},Router.prototype.getMatchedParams=function(a,b,c){var d=b.match(/:\w+/g),e=a.match(c),f={};if(d)for(var g=0;g<d.length;g++){var h=d[g].slice(1);f[h]=e[g]}return f},Router.prototype.dispatch=function(a){var b=this.match(a);b&&b.handler.call(null,a,b.params)},Nav.prototype.bind=function(a){var b=this,c=Array.prototype.slice.call(a.getElementsByTagName("a")),d=function(a){"/"===a.getAttribute("href")[0]&&a.addEventListener("click",function(a){a.preventDefault();for(var c=a.target;"a"!==c.tagName.toLowerCase();)c=c.parentElement;b.go(c.getAttribute("href"))})};c.forEach(d)},Nav.prototype.observe=function(a){var b=this,c={attributes:!0,childList:!0,characterData:!0},d=new MutationObserver(function(a){b.bind(a[0].target)});d.observe(a,c)},Nav.prototype.go=function(a){var b=new CustomEvent("navigate",{url:a});history.pushState&&history.pushState({},"",a),window.dispatchEvent(b)},function(){var a=new Router,b=function(a){var b=document.getElementById("main");b.classList.add("loading"),fetch(a+"?ajax=1").then(function(a){return a.text()}).then(function(a){b.innerHTML=a,b.classList.remove("loading")})};a.addRoute("/",b),a.addRoute("/:slug",b),a.addRoute("/shows/:slug",b),window.addEventListener("load",function(){var b=new Nav(function(){a.dispatch(location.pathname)});if(b.bind(document),b.observe(document.getElementById("main")),b.go(location.pathname),Array.prototype.slice.call(document.getElementsByClassName("nav-link")).forEach(function(a){a.addEventListener("click",function(){document.getElementById("nav-trigger").checked=!1})}),window.addEventListener("scroll",function(){var a=document.documentElement.scrollTop||document.body.scrollTop;0===a?document.getElementsByClassName("site-heading-wrapper")[0].classList.remove("corner"):document.getElementsByClassName("site-heading-wrapper")[0].classList.add("corner")}),(document.documentElement.scrollTop||document.body.scrollTop)>0&&document.getElementsByClassName("site-heading-wrapper")[0].classList.add("corner"),document.getElementById("open-player-btn").addEventListener("click",function(){var a=document.getElementById("player-wrapper");a.classList.contains("open")?a.classList.remove("open"):a.classList.add("open")}),!window.localStorage.repeatVisit){var c=document.getElementById("open-player-btn-wrapper");c.classList.add("bouncy"),window.localStorage.repeatVisit=!0}})}();